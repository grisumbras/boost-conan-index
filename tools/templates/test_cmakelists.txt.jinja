cmake_minimum_required(VERSION 3.15)
project(PackageTest CXX)

set(Boost_USE_MULTITHREADED  OFF)
set(Boost_USE_STATIC_LIBS ON)
set(Boost_ARCHITECTURE)
find_package(boost-{{ project.name }} CONFIG REQUIRED)

add_executable(test_program test.cpp)
target_link_libraries(test_program PRIVATE
{% if project.name == 'test' %}
    Boost::unit_test_framework
{% else %}
    Boost::{{ project.name }}
{% endif %}
)

{% if project.name in ('python', 'parameter_python') %}

find_package(Python COMPONENTS Development REQUIRED)
target_link_libraries(test_program PRIVATE Python::Python)

{% elif project.name  == 'mpi' %}

find_package(MPI COMPONENTS CXX REQUIRED)
target_link_libraries(test_program PRIVATE MPI::MPI_CXX)

{% elif project.name  == 'compute' %}

find_package(OpenCL)
target_include_directories(test_program PRIVATE "${OpenCL_INCLUDE_DIR}")

{% endif %}


include(CTest)
add_test(NAME test COMMAND test_program)
